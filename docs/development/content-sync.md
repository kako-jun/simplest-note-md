# コンテンツ同期機能

Agasteerのコンテンツ同期機能の実装詳細について説明します。

## リーフのタイトルと#見出しの同期

### 双方向同期の仕様

リーフのタイトルとコンテンツの1行目の`# 見出し`が自動的に同期します。

#### コンテンツ → タイトル

1行目が `# ` で始まる場合、`extractH1Title()`でタイトルを抽出し、リーフのタイトルが自動更新されます。グローバルストアを更新することで左右ペイン両方に反映されます。

#### タイトル → コンテンツ

パンくずリストでタイトルを変更すると、`updateH1Title()`で1行目の`# 見出し`も自動更新されます。

### 新規リーフの初期コンテンツ

リーフを新規作成すると、以下の初期コンテンツが設定されます：

- 1行目: `# リーフ名`（自動生成されたタイトルが見出しになる）
- 2行目: 空行
- 3行目: 空行（カーソル位置）

### 適用条件

- **`#` のみ対応**: `## 見出し2` や `### 見出し3` には適用されません
- **スペース必須**: `#見出し`（スペースなし）はマッチしません
- **1行目のみ**: 2行目以降の見出しは無視されます

### 2ペイン表示での同期

左右のペインで同じリーフを開いている場合、どちらかのペインで編集すると**両方のペインに即座に反映**されます。

グローバルストアを更新し、左右のペインローカル変数も同時に更新することで同期を実現しています。

**動作例**:

- 左ペインでリーフAを編集 → 右ペインでも同じリーフAを開いている場合、即座に同期
- 左ペインでリーフA、右ペインでリーフBを編集 → それぞれ独立して動作
